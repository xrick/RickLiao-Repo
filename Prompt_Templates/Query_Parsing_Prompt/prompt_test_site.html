  <!DOCTYPE html>
  <html lang="zh-TW">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>æç¤ºå·¥ç¨‹æ¸¬è©¦å¹³å° - Ollama GPT-OSS:20B</title>
      <script src="https://cdn.tailwindcss.com"></script>
      <style>
          .loading-spinner {
              border: 3px solid #f3f3f3;
              border-top: 3px solid #3498db;
              border-radius: 50%;
              width: 20px;
              height: 20px;
              animation: spin 1s linear infinite;
              display: inline-block;
              margin-left: 10px;
          }
          
          @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
          }
          
          .prompt-template {
              cursor: pointer;
              transition: all 0.3s ease;
          }
          
          .prompt-template:hover {
              transform: translateY(-2px);
              box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          }
      </style>
  </head>
  <body class="bg-gray-50">
      <div class="container mx-auto px-4 py-8 max-w-6xl">
          <!-- æ¨™é¡Œå€ -->
          <header class="text-center mb-8">
              <h1 class="text-4xl font-bold text-gray-800 mb-2">æç¤ºå·¥ç¨‹æ¸¬è©¦å¹³å°</h1>
              <p class="text-gray-600">ä½¿ç”¨ Ollama + GPT-OSS:20B é€²è¡Œæç¤ºè©æ¸¬è©¦èˆ‡å„ªåŒ–</p>
              <div class="mt-4 flex items-center justify-center gap-4">
                  <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm" id="connection-status">
                      âš¡ é€£æ¥ç‹€æ…‹ï¼šæª¢æŸ¥ä¸­...
                  </span>
                  <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">
                      ğŸ¤– æ¨¡å‹ï¼šgpt-oss:20b
                  </span>
              </div>
          </header>

          <!-- ä¸»è¦å…§å®¹å€ -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <!-- å·¦å´ï¼šæç¤ºè©è¼¸å…¥å€ -->
              <div class="lg:col-span-2 space-y-6">
                  <!-- ç³»çµ±æç¤ºè© -->
                  <div class="bg-white rounded-lg shadow-md p-6">
                      <h2 class="text-xl font-semibold mb-4 text-gray-700">ç³»çµ±æç¤ºè© (System Prompt)</h2>
                      <textarea 
                          id="system-prompt" 
                          class="w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          placeholder="è¨­å®šæ¨¡å‹çš„è§’è‰²ã€è¡Œç‚ºæº–å‰‡å’Œå›æ‡‰é¢¨æ ¼..."
                      >ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„AIåŠ©æ‰‹ï¼Œè«‹ç”¨ç¹é«”ä¸­æ–‡å›ç­”å•é¡Œã€‚å›ç­”æ™‚è¦æº–ç¢ºã€æœ‰æ¢ç†ï¼Œä¸¦ä¿æŒå‹å–„çš„èªæ°£ã€‚</textarea>
                  </div>

                  <!-- ä½¿ç”¨è€…æç¤ºè© -->
                  <div class="bg-white rounded-lg shadow-md p-6">
                      <h2 class="text-xl font-semibold mb-4 text-gray-700">ä½¿ç”¨è€…æç¤ºè© (User Prompt)</h2>
                      <textarea 
                          id="user-prompt" 
                          class="w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          placeholder="è¼¸å…¥æ‚¨æƒ³æ¸¬è©¦çš„æç¤ºè©..."
                      ></textarea>
                      
                      <!-- åƒæ•¸è¨­å®š -->
                      <div class="mt-4 grid grid-cols-2 gap-4">
                          <div>
                              <label class="block text-sm font-medium text-gray-700 mb-1">Temperature</label>
                              <input 
                                  type="range" 
                                  id="temperature" 
                                  min="0" 
                                  max="2" 
                                  step="0.1" 
                                  value="0.7"
                                  class="w-full"
                              >
                              <span id="temp-value" class="text-sm text-gray-600">0.7</span>
                          </div>
                          <div>
                              <label class="block text-sm font-medium text-gray-700 mb-1">Max Tokens</label>
                              <input 
                                  type="number" 
                                  id="max-tokens" 
                                  value="1000"
                                  min="50"
                                  max="4000"
                                  class="w-full px-3 py-1 border border-gray-300 rounded"
                              >
                          </div>
                      </div>
                      
                      <button 
                          id="send-btn"
                          class="mt-4 w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition duration-200 font-medium"
                      >
                          ç™¼é€æ¸¬è©¦
                      </button>
                  </div>

                  <!-- å›æ‡‰å€ -->
                  <div class="bg-white rounded-lg shadow-md p-6">
                      <h2 class="text-xl font-semibold mb-4 text-gray-700">æ¨¡å‹å›æ‡‰</h2>
                      <div id="response-area" class="min-h-[200px] p-4 bg-gray-50 rounded-lg whitespace-pre-wrap">
                          <p class="text-gray-500">ç­‰å¾…ç™¼é€æç¤ºè©...</p>
                      </div>
                      <div class="mt-4 flex justify-between items-center text-sm text-gray-600">
                          <span id="response-time"></span>
                          <span id="token-count"></span>
                      </div>
                  </div>
              </div>

              <!-- å³å´ï¼šæç¤ºè©ç¯„æœ¬å’Œæ­·å²è¨˜éŒ„ -->
              <div class="space-y-6">
                  <!-- æç¤ºè©ç¯„æœ¬ -->
                  <div class="bg-white rounded-lg shadow-md p-6">
                      <h2 class="text-xl font-semibold mb-4 text-gray-700">æç¤ºè©ç¯„æœ¬</h2>
                      <div class="space-y-3">
                          <div class="prompt-template p-3 bg-gray-50 rounded-lg" onclick="loadTemplate('summary')">
                              <h3 class="font-medium text-gray-800">ğŸ“ æ–‡ç« æ‘˜è¦</h3>
                              <p class="text-sm text-gray-600 mt-1">ç”Ÿæˆæ–‡ç« çš„ç²¾ç°¡æ‘˜è¦</p>
                          </div>
                          <div class="prompt-template p-3 bg-gray-50 rounded-lg" onclick="loadTemplate('translate')">
                              <h3 class="font-medium text-gray-800">ğŸŒ ç¿»è­¯åŠ©æ‰‹</h3>
                              <p class="text-sm text-gray-600 mt-1">å°ˆæ¥­çš„å¤šèªè¨€ç¿»è­¯</p>
                          </div>
                          <div class="prompt-template p-3 bg-gray-50 rounded-lg" onclick="loadTemplate('code')">
                              <h3 class="font-medium text-gray-800">ğŸ’» ç¨‹å¼ç¢¼ç”Ÿæˆ</h3>
                              <p class="text-sm text-gray-600 mt-1">æ ¹æ“šéœ€æ±‚ç”Ÿæˆç¨‹å¼ç¢¼</p>
                          </div>
                          <div class="prompt-template p-3 bg-gray-50 rounded-lg" onclick="loadTemplate('creative')">
                              <h3 class="font-medium text-gray-800">ğŸ¨ å‰µæ„å¯«ä½œ</h3>
                              <p class="text-sm text-gray-600 mt-1">æ•…äº‹ã€è©©æ­Œç­‰å‰µæ„å…§å®¹</p>
                          </div>
                      </div>
                  </div>

                  <!-- æ¸¬è©¦æ­·å² -->
                  <div class="bg-white rounded-lg shadow-md p-6">
                      <h2 class="text-xl font-semibold mb-4 text-gray-700">æ¸¬è©¦æ­·å²</h2>
                      <div id="history-list" class="space-y-2 max-h-96 overflow-y-auto">
                          <p class="text-gray-500 text-sm">å°šç„¡æ¸¬è©¦è¨˜éŒ„</p>
                      </div>
                      <button 
                          onclick="clearHistory()"
                          class="mt-4 w-full text-red-600 text-sm hover:text-red-700"
                      >
                          æ¸…é™¤æ­·å²è¨˜éŒ„
                      </button>
                  </div>
              </div>
          </div>

          <!-- è¨­å®šå€ -->
          <div class="mt-8 bg-white rounded-lg shadow-md p-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-700">Ollama é€£æ¥è¨­å®š</h2>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Ollama API ä½å€</label>
                      <input 
                          type="text" 
                          id="ollama-url" 
                          value="http://localhost:11434"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                      >
                  </div>
                  <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">æ¨¡å‹åç¨±</label>
                      <input 
                          type="text" 
                          id="model-name" 
                          value="gpt-oss:20b"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                      >
                  </div>
              </div>
              <button 
                  onclick="testConnection()"
                  class="mt-4 bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"
              >
                  æ¸¬è©¦é€£æ¥
              </button>
          </div>
      </div>

      <script>
          // å…¨åŸŸè®Šæ•¸
          let testHistory = [];
          
          // åˆå§‹åŒ–
          document.addEventListener('DOMContentLoaded', function() {
              // è¼‰å…¥æ­·å²è¨˜éŒ„
              loadHistory();
              
              // ç¶å®šäº‹ä»¶
              document.getElementById('temperature').addEventListener('input', function(e) {
                  document.getElementById('temp-value').textContent = e.target.value;
              });
              
              document.getElementById('send-btn').addEventListener('click', sendPrompt);
              
              // æ¸¬è©¦é€£æ¥
              testConnection();
          });
          
          // æç¤ºè©ç¯„æœ¬
          const templates = {
              summary: {
                  system: "ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„æ–‡ç« æ‘˜è¦åŠ©æ‰‹ã€‚è«‹ç”¨ç¹é«”ä¸­æ–‡ç”Ÿæˆç°¡æ½”ã€æº–ç¢ºçš„æ‘˜è¦ï¼Œä¿ç•™é—œéµä¿¡æ¯ã€‚",
                  user: "è«‹ç‚ºä»¥ä¸‹æ–‡ç« ç”Ÿæˆä¸€å€‹ç´„100å­—çš„æ‘˜è¦ï¼š\n\n[åœ¨æ­¤è²¼ä¸Šæ–‡ç« å…§å®¹]"
              },
              translate: {
                  system: "ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ç¿»è­¯å“¡ï¼Œç²¾é€šå¤šç¨®èªè¨€ã€‚è«‹æä¾›æº–ç¢ºã€æµæš¢çš„ç¿»è­¯ï¼Œä¸¦ä¿æŒåŸæ–‡çš„èªæ°£å’Œé¢¨æ ¼ã€‚",
                  user: "è«‹å°‡ä»¥ä¸‹å…§å®¹å¾è‹±æ–‡ç¿»è­¯æˆç¹é«”ä¸­æ–‡ï¼š\n\n[åœ¨æ­¤è¼¸å…¥è¦ç¿»è­¯çš„å…§å®¹]"
              },
              code: {
                  system: "ä½ æ˜¯ä¸€å€‹è³‡æ·±çš„ç¨‹å¼é–‹ç™¼è€…ã€‚è«‹ç”Ÿæˆæ¸…æ™°ã€é«˜æ•ˆã€æœ‰è‰¯å¥½è¨»è§£çš„ç¨‹å¼ç¢¼ã€‚",
                  user: "è«‹ç”¨Pythonç·¨å¯«ä¸€å€‹å‡½æ•¸ï¼ŒåŠŸèƒ½æ˜¯ï¼š[æè¿°åŠŸèƒ½éœ€æ±‚]"
              },
              creative: {
                  system: "ä½ æ˜¯ä¸€å€‹å¯Œæœ‰å‰µæ„çš„ä½œå®¶ã€‚è«‹ç™¼æ®æƒ³åƒåŠ›ï¼Œå‰µä½œå¼•äººå…¥å‹çš„å…§å®¹ã€‚",
                  user: "è«‹ä»¥ã€Œ[ä¸»é¡Œ]ã€ç‚ºé¡Œï¼Œå¯«ä¸€å€‹300å­—çš„çŸ­ç¯‡æ•…äº‹ã€‚"
              }
          };
          
          // è¼‰å…¥ç¯„æœ¬
          function loadTemplate(type) {
              const template = templates[type];
              document.getElementById('system-prompt').value = template.system;
              document.getElementById('user-prompt').value = template.user;
          }
          
          // ç™¼é€æç¤ºè©
          async function sendPrompt() {
              const systemPrompt = document.getElementById('system-prompt').value;
              const userPrompt = document.getElementById('user-prompt').value;
              const temperature = parseFloat(document.getElementById('temperature').value);
              const maxTokens = parseInt(document.getElementById('max-tokens').value);
              const ollamaUrl = document.getElementById('ollama-url').value;
              const modelName = document.getElementById('model-name').value;
              
              if (!userPrompt.trim()) {
                  alert('è«‹è¼¸å…¥ä½¿ç”¨è€…æç¤ºè©');
                  return;
              }
              
              const sendBtn = document.getElementById('send-btn');
              const responseArea = document.getElementById('response-area');
              
              // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
              sendBtn.disabled = true;
              sendBtn.innerHTML = 'è™•ç†ä¸­<span class="loading-spinner"></span>';
              responseArea.innerHTML = '<p class="text-gray-500">æ­£åœ¨ç”Ÿæˆå›æ‡‰...</p>';
              
              const startTime = Date.now();
              
              try {
                  const response = await fetch(`${ollamaUrl}/api/generate`, {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify({
                          model: modelName,
                          prompt: `${systemPrompt}\n\nUser: ${userPrompt}\n\nAssistant:`,
                          stream: false,
                          options: {
                              temperature: temperature,
                              num_predict: maxTokens
                          }
                      })
                  });
                  
                  if (!response.ok) {
                      throw new Error(`HTTP error! status: ${response.status}`);
                  }
                  
                  const data = await response.json();
                  const endTime = Date.now();
                  const responseTime = ((endTime - startTime) / 1000).toFixed(2);
                  
                  // é¡¯ç¤ºå›æ‡‰
                  responseArea.innerHTML = `<div class="text-gray-800">${escapeHtml(data.response)}</div>`;
                  document.getElementById('response-time').textContent = `å›æ‡‰æ™‚é–“ï¼š${responseTime}ç§’`;
                  document.getElementById('token-count').textContent = `Tokenæ•¸ï¼š${data.eval_count || 'N/A'}`;
                  
                  // å„²å­˜åˆ°æ­·å²è¨˜éŒ„
                  addToHistory({
                      timestamp: new Date().toLocaleString('zh-TW'),
                      systemPrompt: systemPrompt,
                      userPrompt: userPrompt,
                      response: data.response,
                      temperature: temperature,
                      responseTime: responseTime
                  });
                  
              } catch (error) {
                  console.error('Error:', error);
                  responseArea.innerHTML = `<p class="text-red-600">éŒ¯èª¤ï¼š${error.message}</p>`;
              } finally {
                  sendBtn.disabled = false;
                  sendBtn.innerHTML = 'ç™¼é€æ¸¬è©¦';
              }
          }
          
          // æ¸¬è©¦é€£æ¥
          async function testConnection() {
              const statusElement = document.getElementById('connection-status');
              const ollamaUrl = document.getElementById('ollama-url').value;
              
              statusElement.innerHTML = 'â³ é€£æ¥ç‹€æ…‹ï¼šæª¢æŸ¥ä¸­...';
              statusElement.className = 'px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm';
              
              try {
                  const response = await fetch(`${ollamaUrl}/api/tags`);
                  if (response.ok) {
                      statusElement.innerHTML = 'âœ… é€£æ¥ç‹€æ…‹ï¼šå·²é€£æ¥';
                      statusElement.className = 'px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm';
                  } else {
                      throw new Error('é€£æ¥å¤±æ•—');
                  }
              } catch (error) {
                  statusElement.innerHTML = 'âŒ é€£æ¥ç‹€æ…‹ï¼šæœªé€£æ¥';
                  statusElement.className = 'px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm';
              }
          }
          
          // æ­·å²è¨˜éŒ„åŠŸèƒ½
          function addToHistory(item) {
              testHistory.unshift(item);
              if (testHistory.length > 10) {
                  testHistory = testHistory.slice(0, 10);
              }
              localStorage.setItem('promptTestHistory', JSON.stringify(testHistory));
              updateHistoryDisplay();
          }
          
          function loadHistory() {
              const saved = localStorage.getItem('promptTestHistory');
              if (saved) {
                  testHistory = JSON.parse(saved);
                  updateHistoryDisplay();
              }
          }
          
          function updateHistoryDisplay() {
              const historyList = document.getElementById('history-list');
              if (testHistory.length === 0) {
                  historyList.innerHTML = '<p class="text-gray-500 text-sm">å°šç„¡æ¸¬è©¦è¨˜éŒ„</p>';
                  return;
              }
              
              historyList.innerHTML = testHistory.map((item, index) => `
                  <div class="p-3 bg-gray-50 rounded cursor-pointer hover:bg-gray-100" onclick="loadHistoryItem(${index})">
                      <p class="text-sm font-medium text-gray-800">${item.userPrompt.substring(0, 50)}...</p>
                      <p class="text-xs text-gray-500 mt-1">${item.timestamp} | ${item.responseTime}ç§’</p>
                  </div>
              `).join('');
          }
          
          function loadHistoryItem(index) {
              const item = testHistory[index];
              document.getElementById('system-prompt').value = item.systemPrompt;
              document.getElementById('user-prompt').value = item.userPrompt;
              document.getElementById('temperature').value = item.temperature;
              document.getElementById('temp-value').textContent = item.temperature;
              document.getElementById('response-area').innerHTML = `<div class="text-gray-800">${escapeHtml(item.response)}</div>`;
          }
          
          function clearHistory() {
              if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æ­·å²è¨˜éŒ„å—ï¼Ÿ')) {
                  testHistory = [];
                  localStorage.removeItem('promptTestHistory');
                  updateHistoryDisplay();
              }
          }
          
          // å·¥å…·å‡½æ•¸
          function escapeHtml(text) {
              const map = {
                  '&': '&amp;',
                  '<': '&lt;',
                  '>': '&gt;',
                  '"': '&quot;',
                  "'": '&#039;'
              };
              return text.replace(/[&<>"']/g, m => map[m]);
          }
      </script>
  </body>
  </html>